{% extends "::base.html.twig" %}

{% block title %}Reservas{% endblock %}

{% block body %}
{% for flash_message in app.session.flashbag.get('notice') %}
<div class="flash-notice">
	{{ flash_message }}
</div>
{% endfor %}
<div class="white-box">
	<a href="{{ path ('solicitudes_new')}}" class="btn btn-success">Nuevo</a>
	<div class="panel-body">
		<table class="myTable">
			<thead>
				<tr>
					<th>Id</th>
					<th>fecha</th>
					<th>llegada</th>
					<th>Salida</th>
					<th>Menores</th>
					<th>Adultos</th>
					<th>Status</th>
					<th>Acciones</th>
				</tr>
			</thead>
			<tbody>
				{% for reserva in reservas %}
				<tr>
					<td>{{reserva.id}}</td>
					<td>{{reserva.fecha|date('d-m-y')}}</td>
					<td>{{reserva.llegada|date('d-m-y')}}</td>
					<td>{{reserva.salida|date('d-m-y')}}</td>
					<td>{{reserva.menor}}</td>
					<td>{{reserva.adulto}}</td>
					<td>{{reserva.status}}</td>
					<td>
						{% if app.user.rola == 'ADMIN' and reserva.status == 'Pendiente' %}
							<a class="btn btn-success" href="{{ path ('solicitudes_changeStatus',{'id':reserva.id ,'status':'Aprobada','statusRedirect':statusRedirect})}}">Aprobar</a>
							<a class="btn btn-danger" href="{{ path ('solicitudes_changeStatus',{'id':reserva.id ,'status':'Rechazada','statusRedirect':statusRedirect})}}">Rechazar</a>
						{% endif %}
						{% if app.user.rola == 'USER' and reserva.status == 'Aprobada' %}
						<a class="btn btn-success" href="{{ path ('reservas_new',{'id':reserva.id})}}">Completar</a>
						{% endif %}
					</td>
				</tr>
				{% endfor %}
				{% if app.user.rola == 'USER' %}
				{% endif %}
			</tbody>
		</table>
	</div>
</div>

{% endblock %}

{% block javascripts %}
<script>
$('.myTable').DataTable();
</script>
{% endblock %}
